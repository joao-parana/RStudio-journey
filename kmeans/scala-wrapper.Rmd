---
title: "Scala Wrapper"
author: "João Antonio Ferreira"
date: "15 de janeiro de 2017"
output:
  github_document:
    toc: true
    toc_depth: 4
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## R Markdown

Este é um documento R Markdown. Markdown é um formato simples para gerar documentos HTML, DOCX e PDF.

## Preparação do ambiente

Preparando o ambiente para rodar o KMeans da implementação R com o mesmo dataset da implementação Spark

```{r, echo=TRUE, eval=TRUE}
options(max.print=50)
```

```{r, echo=TRUE, eval=FALSE}
remove.packages(c("ggplot2", "data.table"))
install.packages('ggplot2', dep = TRUE)
install.packages('data.table', dep = TRUE)
```

### Lendo o Dataset

```{r, echo=TRUE, eval=TRUE}
myOriginalDataset <- read.delim('/data/prepared-3D_spatial_network.csv', header = TRUE, sep = ',') 
library(ggplot2)
```

### Investigando no grafico

```{r, echo=TRUE, eval=FALSE}
altPlot <- qplot(longitude, latitude, data = myOriginalDataset, colour = altitude)
altPlot
```

![](geo-plus-altitude.png) 


### Rodando o KMeans para k = 8

```{r, echo=TRUE, eval=TRUE}
myDataset = as.matrix(cbind(myOriginalDataset$latitude, myOriginalDataset$longitude), ncol=2)
cl = kmeans(myDataset, 8)
cl_factor = factor(cl$cluster)
cl
```

Os 8 centroides encontrados.

```{r, echo=TRUE, eval=TRUE}
# myDataset$cluster = cl_factor
centers = as.data.frame(cl$centers)
qplot(V2, V1, data = centers)
```

